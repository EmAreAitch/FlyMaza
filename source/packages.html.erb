<% content_for :head do %>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "OfferCatalog",
    "name": "Travel Packages",
    "description": "Explore FlyMaza's curated travel packages for domestic and international destinations. Best prices, expert planning, and unforgettable travel experiences.",
    "url": "<%= config[:root_url] %>/packages/",
    "provider": {
      "@type": "TravelAgency",
      "name": "FlyMaza",
      "url": "<%= config[:root_url] %>"
    },
    "itemListElement": [
      <% all_packages = data.travel.destinations.values.flatten.map(&:packages).flatten %>
      <% all_packages.each_with_index do |package, index| %>
      {
        "@type": "Offer",
        "itemOffered": {
          "@type": "TouristTrip",
          "name": "<%= json_escape(package.title) %>",
          "description": "<%= json_escape(package.description) %>",
          "duration": "<%= package.duration %>",
          "price": "<%= package.price %>"
        }
      }<%= ',' unless index == all_packages.length - 1 %>
      <% end %>
    ]
  }
  </script>
<% end %>

<% destinations = data.travel.destinations %>

<%# Tab Navigation Section %>
<section class="py-12 pt-32">
  <div class="container-custom text-center mb-6">
    <h1 class="heading-section text-gray-900 mb-3">Explore Our Travel Packages</h1>
    <p class="text-gray-600 max-w-2xl mx-auto mb-4">
      Discover amazing places around the world with our carefully curated travel packages. Choose from exciting domestic adventures or incredible international journeys.
    </p>

    <div class="flex justify-center">
      <div class="flex space-x-2 bg-gray-100 rounded-lg p-1">
        <% ['domestic', 'international'].each_with_index do |tab, index| %>
          <button 
            class="tab-button px-6 py-2 text-sm font-semibold rounded-md <%= index.zero? ? 'bg-primary-600 text-white' : 'bg-transparent text-gray-600' %> transition-all duration-200 focus:outline-none cursor-pointer"
            data-tab="<%= tab %>"
            onclick="showTab('<%= tab %>', this)"
          >
            <%= tab.capitalize %> Destinations
          </button>
        <% end %>
      </div>
    </div>
  </div>
</section>

<%# Destinations Content %>
<% ['domestic', 'international'].each do |type| %>
  <div id="<%= type %>-content" class="tab-content <%= 'hidden' unless type == 'domestic' %>">
    <% destinations[type].each do |dest| %>
      <%# Hero Section %>
      <section class="relative h-[400px] bg-cover bg-center overflow-hidden" style="background-image: url('<%= responsive_image(dest[:hero]) %>')">
        <div class="absolute inset-0 gradient-overlay"></div>
        <div class="relative z-10 container-custom flex flex-col justify-center h-full text-white">
          <h2 class="heading-hero mb-4">Packages for <%= dest[:name] %></h2>
          <p class="text-lg md:text-xl max-w-2xl">Handpicked packages to explore <%= dest[:name] %> in style.</p>
        </div>
      </section>

      <%# Packages Grid Section %>
      <section class="py-12">
        <div class="container-custom">
          <div class="mb-8 text-center">
            <h3 class="heading-section text-gray-900">Explore <%= dest[:name] %> Packages</h3>
            <p class="text-gray-600">Choose from our curated selection of travel experiences.</p>
          </div>
          <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
            <% dest[:packages].each do |package| %>
              <%= partial "package", locals: {package:} %>
            <% end %>
          </div>
        </div>
      </section>
    <% end %>
  </div>
<% end %>

<%# Tab JS %>
<script>
  function showTab(tabName, clickedButton) {
    document.querySelectorAll('.tab-content').forEach(c => c.classList.add('hidden'));
    document.querySelectorAll('.tab-button').forEach(b => {
      b.classList.remove('bg-primary-600', 'text-white');
      b.classList.add('bg-transparent', 'text-gray-600');
    });
    document.getElementById(tabName + '-content').classList.remove('hidden');
    clickedButton.classList.remove('bg-transparent', 'text-gray-600');
    clickedButton.classList.add('bg-primary-600', 'text-white');
  }
</script>
